classdef MeshTestSuite < matlab.unittest.TestCase
    methods (Test)
        function ShellMeshTest(testCase)
            [coords, connect, node_normals] = Factory.Shell([1,1],[1,1,0.1]);
            mesh = Mesh(coords,connect,node_normals);
            % Check basic properties
            testCase.verifyEqual(4,mesh.n_nodes);
            testCase.verifyEqual(1,mesh.n_ele);
            testCase.verifyEqual(4,mesh.nodes_per_ele);
            % Check Element creation
            ele = mesh.ele(1);
            testCase.verifyEqual(ele.coords,mesh.coords);
        end
        function ShellFactoryTest(testCase)
            [coords, connect, node_normals] = Factory.Shell([1,1],[1,1,0.1]);
            % Extract basic properties.
            [n_nodes, dim] = size(coords);
            [n_ele, nodes_per_ele] = size(connect);
            % Compare them to expected results.
            testCase.verifyEqual(4,n_nodes);
            testCase.verifyEqual(1,n_ele);
            testCase.verifyEqual(3,dim);
            testCase.verifyEqual(4,nodes_per_ele);
            testCase.verifyEqual(size(node_normals),size(coords));
        end
        function BoxFactoryTest(testCase)
            % Generate simplest box
            [coords, connect] = Factory.Box([1,1,1],[1,1,1]);
            % Extract basic properties.
            [n_nodes, dim] = size(coords);
            [n_ele, nodes_per_ele] = size(connect);
            % Compare them to expected results.
            testCase.verifyEqual(8,n_nodes);
            testCase.verifyEqual(1,n_ele);
            testCase.verifyEqual(3,dim);
            testCase.verifyEqual(8,nodes_per_ele);
        end
    end
end